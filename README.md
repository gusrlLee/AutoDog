# 캡스톤디자인 - AutoDog

이 프로젝트는 졸업 요건으로 진행된 캡스톤디자인 프로젝트입니다. 4족 보행을 하는 개의 모습을 한 하드웨어에 LiDAR 센서와 카메라를 부착하여, 인공지능 서빙 로봇을 모티브로 한 자율 주행 로봇을 개발하는 것을 목표로 하였습니다.

## 프로젝트 개요

AutoDog은 카메라를 이용한 Visual Odometry를 통해 자신의 현재 위치를 추정하고, LiDAR 센서를 활용하여 주변 장애물을 감지합니다. 이를 기반으로 자율적인 장애물 회피 주행이 가능하며, 사용자가 GUI를 통해 목적지를 설정하면 A* 알고리즘을 이용한 경로 계획을 통해 목표 지점까지 이동할 수 있습니다. 

본 시스템은 실제 하드웨어를 사용하는 'Real Mode'와 저장된 데이터셋을 이용하는 'Simulation Mode'의 두 가지 작동 모드를 지원합니다.

## 주요 기능 상세 설명

### 1. 아두이노 (하드웨어 제어 - `DogControl.ino`)

- 로봇 다리 서보모터의 저수준 제어를 담당합니다.
- 메인 C++ 어플리케이션으로부터 시리얼 통신을 통해 다음의 명령들을 수신합니다:
    - `f`: 전진 (forward)
    - `l`: 좌회전 (left turn)
    - `r`: 우회전 (right turn)
    - `s`: 초기 자세 / 일어서기 (initialize/stand-up)
    - `e`: 종료 / 앉기 (end/relax)
- 수신된 명령에 따라 전진, 좌회전, 우회전과 같은 기본 동작을 수행합니다.

### 2. LiDAR 센서 (`Lidar.cpp`, `CentralSystem.cpp`)

- RPLIDAR를 사용하여 주변 환경을 360도로 스캔합니다.
- 로봇의 경로 상에 있는 장애물을 감지합니다.
- 실시간 충돌 회피를 위한 데이터를 제공합니다. 시스템은 로봇 전방 및 측면에 정의된 "위험 구역(danger zones)"을 확인합니다.
- LiDAR 데이터는 시각화된 궤적 맵(trajectory map)에도 표시되어 사용자가 확인할 수 있습니다.

### 3. 카메라 (`Camera.cpp`, `VisualOdometry.cpp`, `CentralSystem.cpp`)

- Visual Odometry를 위한 이미지 데이터를 제공합니다.
- **Visual Odometry**:
    - Optical Flow (Lucas-Kanade 방식)를 사용하여 연속된 프레임 간의 특징점(Good Features to Track)을 추적합니다.
    - Essential Matrix 계산 및 Pose 복원을 통해 카메라(로봇)의 움직임(회전 및 이동)을 추정합니다.
    - 이를 통해 로봇의 현재 2D 위치를 작업 환경 내에서 결정합니다.
- 실시간 카메라 영상은 사용자에게 GUI를 통해 표시됩니다.

### 4. 메인 제어 시스템 (C++ - `CentralSystem.cpp`, `main.cpp`)

- 아두이노, LiDAR, 카메라, Visual Odometry 등 모든 하위 시스템을 초기화하고 조정합니다.
- LiDAR 스캐닝, 궤적 계산, 아두이노 통신 등 동시 다발적인 작업을 위한 멀티스레딩을 관리합니다.
- OpenCV 창을 이용한 GUI를 제공하여 다음 기능들을 지원합니다:
    - 카메라 현재 영상 표시.
    - 로봇의 경로, LiDAR 스캔 포인트, 감지된 장애물을 포함하는 궤적 맵 표시.
    - 사용자가 궤적 맵을 클릭하여 로봇의 네비게이션 목표 지점을 설정할 수 있도록 함.
- 자율 주행 로직을 구현합니다:
    - **장애물 회피**: LiDAR에 의해 장애물이 감지되면, 이를 회피하기 위해 좌회전 또는 우회전을 결정합니다. 만약 양쪽 모두 막혀있을 경우, 사전에 정의된 특정 회전(예: 우회전)을 수행할 수 있습니다.
    - **A* 경로 계획**: 사용자에 의해 목적지가 설정되면, 로봇의 현재 위치와 목표 지점을 고려하여 궤적 맵 상에서 A* 알고리즘을 사용해 최적 경로를 계산합니다.
- 장애물 회피 또는 경로 계획을 통해 도출된 상위 레벨의 움직임 명령을 `MotorControlSystem`을 통해 아두이노로 전달합니다.
